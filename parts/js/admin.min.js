!function(t,i,e,s){"use strict";t(e).ready(function(){t("body").wptabs(),n.init()});var n={init:function(){n.meta_boxes(),n.post_name(),n.post_submit_meta_box(),n.thickbox(),n.user_forms(),n.empty_elements(),n.list_tables(),n.widgets(),n.shortcodes(),n.notices(),n.pointers()},notices:function(){t(e).on("click",".notice.is-dismissible > .notice-dismiss",function(i){t.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"piklist_notice",id:t(this).parent().attr("id")}})})},pointers:function(){t.each(piklist.pointers,function(i){var e=this.pointer_id,s=t.extend(this.options,{close:function(){t.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"dismiss-wp-pointer",pointer:e}})}});t(this.target).pointer(s).pointer("open")})},empty_elements:function(){t("#post-body-content").each(function(){""==t.trim(t(this).html())&&t(this).html("")})},user_forms:function(){"WebkitAppearance"in e.documentElement.style&&setTimeout(function(){t("input:-webkit-autofill").each(function(){var i=t(this).attr("name");t(this).after(this.outerHTML).remove(),t("input[name="+i+"]").val("")})},250)},thickbox:function(){t(".piklist-list-table-export-button").on("click",function(){setTimeout(function(){var i=870,e=800;t("#TB_window").css({marginLeft:"-"+parseInt(i/2,10)+"px",width:i+"px",height:e+"px",marginTop:"-"+parseInt(e/2,10)+"px"}),t("#TB_ajaxContent").css({height:e-45+"px"})},100)})},meta_boxes:function(){t(".piklist-meta-box-collapse:not(.piklist-meta-box-lock)").addClass("closed"),t(".piklist-meta-box-lock").addClass("stuffbox").css("box-shadow","none").find("div.handlediv").hide().next("h3.hndle").removeClass("hndle").css("cursor","default"),t(".piklist-meta-box-lock").show(),t(".piklist-meta-box > .inside").each(function(){t(this).find(" > *:first-child").hasClass("piklist-field-container")&&t(this).css({"margin-top":"0"})})},post_name:function(){var i=t("body.wp-admin.post-php form#post:first");if(i.length>0){var e=i.find(":input#post_name");e.length<=0&&i.append(t('<input type="hidden" name="post_name" id="post_name">'))}},post_submit_meta_box:function(){t(".save-post-status","#post-status-select").click(function(i){i.preventDefault();var e=t("#post_status").val(),s=t("#post_status option:selected").text();"draft"!=e&&(t("#save-post").val("Save"),t("#hidden_post_status, #original_publish").val(s),t("#publish").val("Update")),t("#post-status-display").text(s)}),t("#publish","#major-publishing-actions").click(function(){"none"!=t("#post-status-select").css("display")&&t(".save-post-status","#post-status-select").trigger("click"),"none"!=t("#post-visibility-select").css("display")&&t(".save-post-visibility","#post-visibility-select").trigger("click")})},shortcodes:function(){if(t.each(piklist.shortcodes,function(t,i){if(wp.mce.views){var e="undefined"!=typeof i.shortcode?i.shortcode:i;wp.mce.views.register(e,n.shortcode(e))}}),t(i).on("resize",function(){var e=t("#TB_iframeContent");if(e.length>0&&e.attr("src").indexOf("page=shortcode_editor")){var s=Math.round(t(i).width()-60),n=Math.round(t(i).height()-60);t("#TB_window").css({width:s,height:n,top:"50%","margin-left":-s/2,"margin-top":-n/2}).find("iframe").css({width:"100%",height:n-t("#TB_title").height()})}}),t(e).on("click",".piklist-shortcode-button",function(e){e.preventDefault();var s="Insert Shortcode",n="undefined"!=typeof parent.tinymce.activeEditor?parent.tinymce.activeEditor:!1,a=i.location!=i.parent.location,o=n&&!a?n.selection.getContent({format:"html"}):null,r=location.href,d=r.substr(0,r.indexOf("/wp-"))+"/wp-admin/admin.php",p={page:"shortcode_editor"};"undefined"!=typeof pagenow&&t.inArray(pagenow,["post","post-new"])>-1&&(p[piklist.prefix+"post[ID]"]=t("#post_ID").val()),p[piklist.prefix+"[admin_hide_ui]"]="true",o&&!a&&(p[piklist.prefix+"shortcode_data[content][]"]=o),p.TB_iframe="true",tb_show(s,d+"?"+t.param(p)),t(i,parent).trigger("resize")}),t("form#_shortcode").length>0)if(t("div#piklist_form_admin_notice.update").length>0){for(var s,a=t(':input[name^="'+piklist.prefix+'shortcode_data["]').serializeArray(),o={attrs:{},type:"single"},r=null,d="",p="",l=0;l<a.length;l++)r=a[l].name.replace(piklist.prefix+"shortcode_data[","").replace(/[\[\]']+/g,""),"content"==r?(o.content=parent.switchEditors._wp_Nop(a[l].value),o.type="closed"):"name"==r&&(o.tag=a[l].value);a=t(':input[name^="'+piklist.prefix+'shortcode["]').serializeArray();for(var l=0;l<a.length;l++)s=(piklist.prefix+"shortcode").length+1,r=a[l].name.substr(s,a[l].name.indexOf("]")-s),"id"!=r.toLowerCase()&&(d+=r+'="'+a[l].value+'" ');o.attrs=wp.shortcode.attrs(d),p=wp.shortcode.string(o);var c=t(e).triggerHandler("piklist:shortcode:insert",[p,o]);"undefined"!=typeof c&&(p=c),parent.send_to_editor(p),parent.switchEditors.go(parent.tinymce.activeEditor.id,"html"),parent.switchEditors.go(parent.tinymce.activeEditor.id,"tmce"),parent.tb_remove()}else t("ul.piklist-shortcodes > .attachment").on("click",function(i){t('input[name="'+piklist.prefix+'shortcode_data[name][]"]').val(t(this).attr("data-piklist-shortcode"));var e=t(':input[name^="'+piklist.prefix+'shortcode_data["]').serializeArray(),s="undefined"!=typeof pagenow&&t.inArray(pagenow,["post","post-new"])>-1?"&"+piklist.prefix+"post[ID]="+t("#post_ID").val():null,n={};t.each(e,function(t,i){n[i.name]=i.value}),location.href=location.href+(location.href.indexOf("?")>-1?"&":"?")+t.param(n)+(s?s:"")})},shortcode:function(e){return{template:wp.media.template("piklist-shortcode"),View:{template:wp.media.template("piklist-shortcode"),initialize:function(t){this.shortcode=t.shortcode},getHtml:function(){return this.getContent()}},getContent:function(){if(piklist.shortcodes[this.shortcode.tag].preview===!0){var e="undefined"!=typeof tinymce?tinymce.Env.ie:!1,s=t("<iframe/>"),n="piklist-shortcode-preview-"+this.shortcode.tag+"-"+Math.random().toString(36).substr(2,16);return s.attr("id",n).attr("src",e?'javascript:""':"").attr("frameBorder","0").attr("allowTransparency","true").attr("scrolling","no").addClass("piklist-shortcode-preview").css({width:"100%",height:"1",display:"block"}),t.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"piklist_shortcode",shortcode:wp.shortcode.string(this.shortcode),post_id:t("#post_ID").val(),preview_id:n},success:function(e){t(".wp-editor-wrap iframe").each(function(){var s=t(this).contents().find("iframe#"+e.data.preview_id);if(s.length>0){var n=i.MutationObserver||i.WebKitMutationObserver||i.MozMutationObserver,a=s.contents().find("head"),o=s.contents().find("body"),r=function(){s.height(s.contents().find("html").outerHeight())};if(t(this).contents().find("head").find("link").each(function(){a.append(t(this).prop("outerHTML"))}),o.css("min-height","100%").html(e.data.html),r(),n){var d=new n(function(){r(),s.contents().find("img,link").load(r)});d.observe(s.contents()[0],{attributes:!0,childList:!0,subtree:!0})}else for(var p=1;6>p;p++)setTimeout(r,700*p)}})}}),s.prop("outerHTML")}return this.template({tag:this.shortcode.tag,attributes:this.shortcode.attrs.named,options:"undefined"!=typeof piklist.shortcodes[this.shortcode.tag]?piklist.shortcodes[this.shortcode.tag]:{name:this.shortcode.tag.replace(/_/g," ").toUpperCase()}})},ui:function(){return this.template({tag:this.shortcode.tag,attributes:this.shortcode.attrs.named,options:"undefined"!=typeof piklist.shortcodes[this.shortcode.tag]?piklist.shortcodes[this.shortcode.tag]:{name:this.shortcode.tag.replace(/_/g," ").toUpperCase()}})},edit:function(e){"object"==typeof e&&(e=decodeURIComponent(t(e).attr("data-wpview-text")));var s={},n=wp.shortcode.regexp(this.type),a=n.exec(e);if(n.lastIndex=0,a){s={attrs:wp.shortcode.attrs(a[3]),tag:this.type,content:a[5],type:"undefined"!=typeof a[6]?"closed":"single"};var o=location.href.substr(0,location.href.indexOf("/wp-"))+"/wp-admin/admin.php",r={page:"shortcode_editor"};"undefined"!=typeof pagenow&&t.inArray(pagenow,["post","post-new"])>-1&&(r[piklist.prefix+"post[ID]"]=t("#post_ID").val()),r[piklist.prefix+"[admin_hide_ui]"]="true",t.each(s.attrs.named,function(t,i){r[piklist.prefix+"shortcode["+t+"]"]=i}),r[piklist.prefix+"shortcode_data[name][]"]=s.tag,r[piklist.prefix+"shortcode_data[action][]"]="update","undefined"!=typeof s.content&&(r[piklist.prefix+"shortcode_data[content][]"]=switchEditors._wp_Nop(s.content)),r.TB_iframe="true",tb_show("Edit "+(piklist.shortcodes[this.type].name?piklist.shortcodes[this.type].name:null),o+"?"+t.param(r)),t(i).trigger("resize")}}}},widgets:function(){t(e).on("mousedown",'.widget input[name="savewidget"]',function(){var i=t(this),e=i.parents(".widget-control-actions:first").siblings(".widget-content:first"),s=i.parents(".widget").find(".widget-title h4"),n=i.parents("form").find(".piklist-universal-widget-form-container").attr("data-widget-title");"undefined"!=typeof tinyMCE&&(tinyMCE.triggerSave(),e.find(".wp-editor-area").each(function(){"undefined"!=typeof switchEditors&&switchEditors.go(t(this).attr("id"),"tmce")})),t(".piklist-universal-widget-form-container").on("remove",function(){e.css({height:e.outerHeight(),overflow:"hidden"}),e.removeData("wptabs").removeData("piklistgroups").removeData("piklistcolumns").removeData("piklistmediaupload").removeData("piklistaddmore").removeData("piklistfields"),setTimeout(function(){e.find(".piklist-universal-widget-form-container").wptabs().piklistgroups().piklistcolumns().piklistmediaupload().piklistaddmore({sortable:!0}).piklistfields(),"undefined"!=typeof n&&s.find(".in-widget-title").text(":  "+n),e.css({height:"auto",overflow:"visible"})},50)})}),n.widget_title();var i=null;t(e).on("change",".piklist-universal-widget-select",function(){var e=t(this).val(),s=t(this).attr("data-piklist-addon"),a=("piklist-universal-widget-"+s).replace(/-/g,"_"),o=t(this).parents(".widget-content"),r=(t(this).attr("class").split(" "),o.find(".piklist-universal-widget-form-container")),d=t(this).attr("name").split("[")[1].replace(/\]/g,""),p=t(this).parents(".widget").find(".widget-title h4"),l=o.find(".piklist-universal-widget-select-container p"),c=o.attr("data-piklist-wptab-active");i=o.parents(".widget-inside:eq(0)"),e&&(r.hide().empty(),t.ajax({type:"POST",url:ajaxurl,async:!1,dataType:"json",data:{action:a,widget:e,number:d},success:function(i){""!=i.tiny_mce&&""!=i.quicktags&&(tinyMCEPreInit.mceInit=t.extend(tinyMCEPreInit.mceInit,i.tiny_mce),tinyMCEPreInit.qtInit=t.extend(tinyMCEPreInit.qtInit,i.quicktags)),p.find(".in-widget-title").text(":  "+i.widget.file_data.title),l.text(i.widget.file_data.description),r.removeData("wptabs").removeData("piklistgroups").removeData("piklistcolumns").removeData("piklistmediaupload").removeData("piklistaddmore").removeData("piklistfields"),r.html(i.form).wptabs().piklistgroups().piklistcolumns().piklistmediaupload().piklistaddmore({sortable:!0}).piklistfields(),o.find(".wp-tab-bar > li").removeClass("wp-tab-active"),o.find(".wp-tab-bar > li:first").addClass("wp-tab-active"),o.find(".wp-tab-bar").length>0&&"undefined"!=typeof c&&o.find(".wp-tab-bar > li").removeClass("wp-tab-active").get(2).addClass("wp-tab-active"),n.widget_dimensions(o,i.widget.file_data.height,i.widget.file_data.width)}}))}),t(".wp-tab-bar li a").on("click",function(i){var e=t(this).parents(".widget-content:first");e.length>0&&e.attr("data-piklist-wptab-active",t(this).text())}),n.widget_title()},widget_title:function(){setTimeout(function(){t(".piklist-universal-widget-form-container").each(function(){var i=t(this).parents(".widget-content"),e=t(this).parents(".widget").find(".widget-title h4"),s=t(this).attr("data-widget-title"),a=t(this).attr("data-widget-height"),o=t(this).attr("data-widget-width");"undefined"!=typeof s&&e.find(".in-widget-title").text(":  "+s),n.widget_dimensions(i,a,o)})},250)},widget_dimensions:function(i,e,s){var n=i.parents(".widget:first"),a=n.find(".widget-inside"),o=n.find(".widget-action:first"),r=!1;a.is(":visible")&&(o.trigger("click"),r=!0),i.siblings('input[name="widget-width"]').val(s?s:250),i.siblings('input[name="widget-height"]').val(e?e:200),t("body.wp-customizer").length>0&&a.find(".widget-content").css({width:s,"max-width":s}).attr("style","max-width: "+s+" !important"),setTimeout(function(){i.find(".piklist-universal-widget-form-container").show(),r&&o.trigger("click")},250)},list_tables:function(){t(".piklist-list-table-export-columns").sortable().disableSelection(),t(".piklist-list-table-export-submit").on("click",function(i){var e=t(this).attr("rel");tb_remove(),t("#"+e).submit()})}},a=function(i,e){this.$element=t(i),this._init()};a.prototype={constructor:a,_init:function(){this.setup(),t(".wp-tab-bar li a").on("click",function(i){i.preventDefault();var e=t(this).closest("li"),s=t(this).closest(".wp-tab-bar").children().index(e),n=t(this).closest(".wp-tab-bar").nextUntil(".wp-tab-bar",".wp-tab-panel");e.addClass("wp-tab-active").siblings().removeClass("wp-tab-active");for(var a=0;a<n.length;a++)t(n[a]).toggle(a==s?!0:!1)})},setup:function(){t(".wp-tab-bar li a").each(function(){var i=t(this).closest("li");if(!i.hasClass("wp-tab-active")){var e=t(this).closest(".wp-tab-bar").children().index(i);t(this).closest(".wp-tab-bar").nextUntil(".wp-tab-bar",".wp-tab-panel").eq(e).hide()}})}},t.fn.wptabs=function(i){var e=Array.apply(null,arguments);return e.shift(),this.each(function(){var s=t(this),n=s.data("wptabs"),o="object"==typeof i&&i;n||s.data("wptabs",n=new a(this,t.extend({},t.fn.wptabs.defaults,o,t(this).data()))),"string"==typeof i&&n[i].apply(n,e)})},t.fn.wptabs.defaults={},t.fn.wptabs.Constructor=a}(jQuery,window,document);